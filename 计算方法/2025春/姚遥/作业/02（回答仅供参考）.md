# 习题 2

> 当 x=1, -1, 2 时，f(x)=0,-3,4，求 f(x) 的二次插值多项式

## Lagrange 插值

$$
\begin{align}
L_{2}(x) &= y_{0} \dfrac{(x-x_{1})(x-x_{2})}{(x_{0}-x_{1})(x_{0}-x_{2})}+y_{1} \dfrac{(x-x_{0})(x-x_2)}{(x_{1}-x_{0})(x_{1}-x_{2})}+y_{2} \dfrac{(x-x_{0})(x-x_{1})}{(x_2-x_{0})(x_{2}-x_{1})} \\
&=-3 \times \dfrac{x^2-3x+2}{-2 \times -3} + 4 \times \dfrac{x^2-1}{1 \times 3} \\
&=-\dfrac{1}{2}(x^2-3x+2)+\dfrac{4}{3}(x^2-1) \\
&=\dfrac{5}{6}x^2+\dfrac{3}{2}x-\dfrac{7}{3}
\end{align}
$$

## Newton 插值

$$
\begin{align}
f(x_{0})&=0 \\
f[x_{0},x_{1}]&=\dfrac{f(x_{1})-f(x_{0})}{x_{1}-x_{0}}=\dfrac{3}{2}  \\
f[x_{0},x_{2}]&=\dfrac{f(x_{2})-f(x_{0})}{x_{2}-x_{0}}=4 \\
f[x_{0},x_{1},x_{2}]&=\dfrac{f[x_{0},x_{2}]-f[x_{0},x_{1}]}{x_{2}-x_{1}}=\dfrac{5}{6}
\end{align}
$$

因此有：

$$
\begin{align}
N_{2}(x)&=f(x_{0})+f[x_{0},x_{1}](x-x_{0})+f[x_{0},x_{1},x_{2}](x-x_{0})(x-x_{1})\\
&=0+\dfrac{3}{2}(x-1)+\dfrac{5}{6}(x^2-1)\\
&=\dfrac{5}{6}x^2+\dfrac{3}{2}x-\dfrac{7}{3}
\end{align}
$$

# 习题 7

> 设 f(x) \in C^2\[a,b] 且 f(a)=f(b)=0，求证 \max\_{a\le x \le b}|f(x)| \le \dfrac{1}{8}(b-a)^2 \max\_{a \le x \le b} |f''(x)|

解：用插值节点 a 和 b 构建线性插值：

$$
L_1(x)=0 \times \dfrac{x-b}{a-b} + 0 \times \dfrac{x-a}{b-a} \equiv 0
$$

则插值余项：

$$
\begin{align}
|R_1(x)|=|f(x)-L_{1}(x)| &\le \dfrac{\max_{a \le \xi \le b} |f''(\xi)|}{2!}|(x-a)(x-b)|\\
&\le \dfrac{1}{8} (b-a)^2 \max_{a \le x \le b} |f''(x)|
\end{align}
$$

因此有：|f(x)| \le \max\_{a \le x \le b} |f(x)| \le \frac{1}{8}(b-a)^2\max\_{a \le x \le b}|f''(x)|

# 习题 10

> 如果 f(x) 是 m 次多项式，记 \Delta f(x)=f(x+h)-f(x)，证明 f(x) 的 k 阶差分 \Delta^kf(x)(0\le k \le m) 是 m-k 次多项式，并且 \Delta^{m+l}f(x)=0（l 为正整数）

解：设 f(x)=\sum\_{i=0}^{m}a\_ix^i，依题意，\Delta^0f(x)=f(x) 为 m-0 阶多项式。已知一阶差分 \Delta f(x)=f(x+h)-f(x)。由于 f(x+h)=\sum\_{i=0}^{m}a\_i(x+h)^i，其 x^m 项系数为 a\_m，与 f(x) 相同；而 x^{m-1} 项系数为 a\_mmh+a\_{m-1}，与 f(x) 不同。因此，\Delta f(x) 是 m-1 次多项式。
假设 k-1 阶差分 \Delta^{k-1}f(x) 是一个 m-k+1 阶多项式，则由 k 阶差分的定义，有 \Delta^kf(x)=\Delta^{k-1}f(x+h)-\Delta^{k-1}f(x)。观察系数同理可得，前后两个多项式的 x^{m-k+1} 阶系数相等，而 x^{m-k} 阶系数不等。因此，由归纳奠基和推理得，\Delta^kf(x) 是一个 m-k 阶多项式。
以此类推，\Delta^{m}f(x) 是一个 0 次多项式，即 \Delta^mf(x)=c（c 为常数）。而 \Delta^{m+1}f(x)=c-c，\Delta^{m+2}f(x)=0-0，以此类推。因此 \Delta^{m+l}f(x)=0（l 为正整数）

# 习题 17

> 证明两点三次 Hermite 插值余项是：
> R\_3(x)=\dfrac{f^{(4)}(\xi)(x-x\_k)^2(x-x\_{k+1})^2}{4!},\xi  \in (x\_k,x\_{k+1})
> 并由此求出分段三次 Hermite 插值的误差限。

解：设两点三次 Hermite 插值函数为 H\_3(x)，且余项 R\_{3}(x) 需满足 R\_{3}(x\_k)=R\_3(x\_{k+1})=0，R\_{3}'(x\_k)=R\_3'(x\_{k+1})=0，即其有两个二重根 x\_k,x\_{k+1}。因此，不妨假设 R\_{3}(x)=f(x)-H\_3(x)=K(x)(x-x\_k)^2(x-x\_{k+1})^2，其中 K(x) 为待定函数。
设 \varphi(t)=f(t)-H\_3(t)-K(x)(t-x\_k)^2(t-x\_{k+1})^2。则有 \varphi(x\_k)=\varphi (x\_{k+1})=\varphi(x)=0 和 \varphi'(x\_k)=\varphi'(x\_{k+1})=0。因此 \varphi(t) 在 (x\_k,x\_{k+1}) 有五个零点 x\_k,x\_k,x\_{k+1},x\_{k+1},x（重根按重数计）
故由 Roll 定理，\varphi^{(4)}(t) 在 (x\_k,x\_{k+1}) 至少有一个零点 \xi，从而 \varphi^{(4)}(\xi)=f^{(4)}(\xi)-4!K(x)=0，可得余项表达式：

$$
R_{3}(x)=\dfrac{f^{(4)}(\xi)(x-x_k)^2(x-x_{k+1})^2}{4!},\xi \in (x_k,x_{k+1})
$$

设三次 Hermite 插值函数 I\_h(x)，考虑在区间 \[x\_k,x\_{k+1}] 内：设 M=\max\_{x\_k < x\<x\_{k+1}}|f^{(4)}(x)|，则 |R\_{3}(x)| \le \dfrac{M}{4!}(x-x\_k)^2(x-x\_{k+1})^2 \le \dfrac{M}{4!}(\dfrac{x\_{k+1}-x\_k}{2})^4。由于 h=\max\_{i=1}^n (x\_i-x\_{i-1})，故误差限为：

$$
\varepsilon(I_h(x))=\dfrac{1}{4!} \max_{x_k<x<x_{k+1}}|f^{(4)}(x)|\left( \dfrac{h}{2} \right)^4= \dfrac{h^4}{384} \max_{x_k<x<x_{k+1}}|f^{(4)}(x)|
$$

# 习题 22

> 求 f(x)=x^2 在 \[a,b] 上的分段线性插值函数 I\_{h}(x)，并估计误差

解：设插值节点为 x\_{0}, x\_{1}, \dots, x\_{n}，满足 a=x\_{0}\<x\_{1}<\dots\<x\_n=b，h=\max\_{i=1}^n(x\_i-x\_{i-1})。基函数 l\_j(x) 满足：

$$
l_j(x)=\begin{cases}
\dfrac{x-x_{j-1}}{x_j-x_{j-1}} & x_{j-1} \le x < x_j \\
\dfrac{x_{j+1}-x}{x_{j+1}-x_j} & x_{j} \le x < x_{j+1} \\
0&\text{otherwise}
\end{cases}
$$

则分段线性插值函数可以表示为：

$$
I_{h}(x)=\sum_{i=0}^{n}f(x_i) l_i(x)=\sum_{i=1}^{n}x_i^2l_i(x) 
$$

假设处于段 \[x\_k,x\_{k+1}]，且 x\_{k+1}-x\_k=h\_{0}，则

$$
\begin{align}
R(x)=f(x)-I_h(x)&=x^2- \left( \dfrac{x-x_k}{x_{k+1}-x_k}x_{k+1}^2+\dfrac{x_{k+1}-x}{x_{k+1}-x_k}x_k^2 \right)  \\
&=x^2-\dfrac{x_{k+1}^2-x_{k}^2}{x_{k+1}-x_k}x-\dfrac{x_{k+1}x_k(x_k-x_{k+1})}{x_{k+1}-x_k} \\
&=x^2-(x_{k+1}+x_k)x+x_{k+1}x_k
\end{align}
$$

因此有 |R(x)| \le |x\_{k+1}x\_k-\dfrac{(x\_{k+1}+x\_k)^2}{4}|=\left|\dfrac{(x\_{k+1}-x\_k)^2}{4}\right|=\dfrac{h\_{0}^2}{4}
由于 h\_{0} \le h，分段线性插值的误差限为 \varepsilon(I\_h(x))=\dfrac{1}{4}h^2

# 习题 2

> 分别用梯形公式和 Simpson 公式计算下列积分
> (1) \int\_0^1 \dfrac{x}{4+x^2} \mathrm{d}x,\quad n=8
> (4) \int\_0^{\pi / 6} \sqrt{ 4-\sin^2\varphi } \mathrm{d}\varphi,\quad n=6

解：(1) 梯形公式：

$$
\begin{align}
\int_0^1 \dfrac{x}{4+x^2} \mathrm{d} x & \approx \dfrac{1}{8}\left( \dfrac{1}{2}f(0)+\dfrac{1}{2} f(1)+\sum_{k=1}^{7} f(\dfrac{k}{8})  \right)   \\
&=\dfrac{1}{8}\left( 0+\dfrac{1}{10}+ \sum_{k=1}^{7} \dfrac{8k}{256+k^2} \right) \\
&\approx 0.11140
\end{align}
$$

Simpson 公式：

$$
\begin{align}
\int_0^1 \dfrac{x}{4+x^2} \mathrm{d} x & \approx \dfrac{1}{48}\left( f(0)+f(1)+\sum_{k=1}^{7} f(\dfrac{k}{8}) + 4\sum_{k=0}^{7} f(\dfrac{2k+1}{16})    \right)   \\
&=\dfrac{1}{48}\left( 0+\dfrac{1}{5}+ \sum_{k=1}^{7} \dfrac{8k}{256+k^2} + \sum_{k=0}^{7} \dfrac{64(2k+1)}{1024+(2k+1)^2} \right) \\
&\approx 0.11157
\end{align}
$$

(4) 梯形公式：

$$
\begin{align}
\int_0^{\pi/6} \sqrt{ 4-\sin^2\varphi } \mathrm{d} \varphi & \approx \dfrac{\pi}{36}\left( \dfrac{1}{2}f(0)+\dfrac{1}{2} f(\dfrac{\pi}{6})+\sum_{k=1}^{5} f(\dfrac{k\pi}{36})  \right)  \\
&\approx 1.0356
\end{align}
$$

Simpson 公式：

$$
\begin{align}
\int_0^{\pi/6} \sqrt{ 4-\sin^2\varphi } \mathrm{d} \varphi & \approx \dfrac{\pi}{216}\left( f(0)+f(\dfrac{\pi}{6})+\sum_{k=1}^{5} f(\dfrac{k\pi}{36})+4\sum_{k=0}^{5} f(\dfrac{(2k+1)\pi}{72})  \right)  \\
&\approx 1.0358
\end{align}
$$

# 习题 5

> 推导下列三种矩形求积公式：
> \begin{align}\int\_a^b f(x)\mathrm{d}x &= (b-a)f(a)+\dfrac{f'(\eta)}{2}(b-a)^2,\\\\\int\_a^b f(x)\mathrm{d}x &= (b-a)f(b)-\dfrac{f'(\eta)}{2}(b-a)^2,\\\\\int\_a^b f(x)\mathrm{d}x &= (b-a)f( \dfrac{a+b}{2})+\dfrac{f''(\eta)}{24}(b-a)^3\end{align}

(1) 由 Lagrange 中值定理：f(x)=f(a)+f'(\eta)(x-a)，两侧同时积分得：

$$
\begin{align}
\int_a^b f(x) \mathrm{d}x &= (b-a)f(a) + f'(\eta) \int_a^b (x-a) \mathrm{d}x \\
&=(b-a) f(a) + \dfrac{f'(\eta)}{2} (b-a)^2
\end{align}
$$

(2) 与 (1) 同理，f(x)=f(b)+f'(\eta)(x-b)，积分得：

$$
\begin{align}
\int_a^b f(x)\mathrm{d}x &= (b-a)f(b) + f'(\eta) \int_a^b(x-b) \mathrm{d}x \\
&=(b-a)f(b)-\dfrac{f'(\eta)}{2}(b-a)^2
\end{align}
$$

(3) 由 Taylor 公式，f(x)=f(\dfrac{a+b}{2})+f'(\dfrac{a+b}{2})(x-\dfrac{a+b}{2}) + \dfrac{f''(\eta)}{2}(x - \dfrac{a+b}{2})^2，因此

$$
\begin{align}
\int_a^b f(x) \mathrm{d}x &= (b-a)f(\dfrac{a+b}{2}) + f'(\dfrac{a+b}{2})\int_a^b (x-\dfrac{a+b}{2}) \mathrm{d}x + \dfrac{f''(\eta)}{2}\int_a^b (x- \dfrac{a+b}{2})^2 \mathrm{d}x \\
&=(b-a)f(\dfrac{a+b}{2})+0+\dfrac{f''(\eta)}{2} \cdot \dfrac{1}{3} \dfrac{(b-a)^3}{4} \\
&=(b-a)f(\dfrac{a+b}{2})+\dfrac{f''(\eta)}{24}(b-a)^3\\
\end{align}
$$

# 习题 7

> 用复化梯形公式求积分 \int\_a^b f(x) \mathrm{d}x。要将积分区间 \[a, b] 分成多少等份，才能保证误差不超过 \varepsilon（不计舍入误差）？

解：若将区间分为 n 等份，则每份宽度为 h=\dfrac{b-a}{n}，此时复化梯形公式为：

$$
T_n = h\left(  \dfrac{1}{2}f(a)+\dfrac{1}{2}f(b)+\sum_{k=1}^{n-1} f(a+kh) \right) 
$$

余项为：

$$
I-T_n= \sum_{k=0}^{n-1} \left[ -\dfrac{h^3}{12}f''(\eta_k) \right]=-\dfrac{b-a}{12}h^2f''(\eta)  
$$

若要使余项不超过 \varepsilon，则需要：

$$
|-\dfrac{b-a}{12} h^2 f''(\eta)| \le \varepsilon
$$

解得：

$$
n \ge \sqrt{ \dfrac{(b-a)^3 \max_{a \le \eta \le b} |f''(\eta)|}{12\varepsilon} }
$$

即至少要分为 n =\left\lceil  \sqrt{ \dfrac{(b-a)^3 \max\_{a \le \eta \le b} |f''(\eta)|}{\varepsilon} }\~\right\rceil 等份。

# 习题 8

> 用 Romberg 方法计算积分 \dfrac{2}{\sqrt{ \pi } } \int\_0^1 e^{-x}\mathrm{d}x，要求误差不超过 10^{-5}

T\_0^{(0)}=\dfrac{f(0)+f(1)}{2} = \dfrac{1}{\sqrt{ \pi }}(\dfrac{1}{e}+1) \approx 0.77174332
T\_0^{(1)}=\dfrac{1}{2}T\_{1} + \dfrac{1}{2} f(\dfrac{1}{2}) \approx 0.728069946
T\_1^{(0)}= \dfrac{4}{3} T\_{0}^{(1)}-\dfrac{1}{3}T^{(0)}\_0 \approx 0.713512151
同理可计算出下表：

| T\_0        | T\_1                    | T\_2                                                  | T\_3        |
| ----------- | ----------------------- | ----------------------------------------------------- | ----------- |
| 0.77174332  |                         |                                                       |             |
| 0.728069946 | 0.713512151             |                                                       |             |
| 0.716982762 | 0.713287034             | 0.713272026                                           |             |
| 0.714200167 | 0.713272635             | 0.713271675                                           | 0.713271670 |
| 由于 \$       | 0.713271670-0.713272026 | \le 3.56 \times 10^{-7} \le 10^{-5}，因此积分结果为 0.71327\$ |             |

# 习题 12

> 用三点公式和五点公式求 f(x)=\dfrac{1}{(1+x)^2} 在 x=1.0,1.1 和 1.2 处的导数值，并估计误差。f(x) 的值如下表：

| x          | 1.0    | 1.1    | 1.2    | 1.3    | 1.4    |
| ---------- | ------ | ------ | ------ | ------ | ------ |
| f(x)       | 0.2500 | 0.2268 | 0.2066 | 0.1890 | 0.1736 |
| 解：由三点公式可得： |        |        |        |        |        |

$$
\begin{align}
f'(1.0)&=\dfrac{1}{0.2} [-3f(1.0)+4f(1.1)-f(1.2)] &=&-0.247  \\
f'(1.1)&=\dfrac{1}{0.2} [-f(1.0)+f(1.2)] &=&-0.217 \\
f'(1.2)&=\dfrac{1}{0.2} [f(1.0)-4f(1.1)+3f(1.2)] &=&-0.187
\end{align}
$$

设 M=\max\_{1.0 \le x \le 1.2}|f'''(x)| = \max\_{1.0 \le x \le 1.2} |-\dfrac{24}{(1+x)^5}|=0.75, h=0.1。由带余项的三点公式可得：

$$
\begin{align}
\varepsilon_{1.0} &= \dfrac{h^2}{3}M=2.5\times 10^{-3} \\
\varepsilon_{1.1} &= \dfrac{h^2}{6}M=1.25\times 10^{-3} \\
\varepsilon_{1.2} &= \dfrac{h^3}{3}M=2.5\times 10^{-3}
\end{align}
$$

由五点公式可得：

$$
\begin{align}
f'(1.0)&=\dfrac{1}{1.2}[-25f(1.0)+48f(1.1)-36f(1.2)+16f(1.3)-3f(1.4)]&=& -0.248\\
f'(1.1)&=\dfrac{1}{1.2}[-3f(1.0)-10f(1.1)+18f(1.2)-6f(1.3)+f(1.4)] &=& -0.216\\
f'(1.2)&=\dfrac{1}{1.2}[f(1.0)-8f(1.1)+8f(1.3)-f(1.4)] &=& -0.188
\end{align}
$$

设 M=\max\_{1.0 \le x \le 1.4} |f^{(5)}(x)|=\max\_{1.0 \le x \le 1.4}|-\dfrac{6!}{(1+x)^7}|=5.625, h=0.1。由余项公式可得误差：

$$
\begin{align}
\varepsilon_{1.0} &= \dfrac{4!}{5!} h^4M=1.125 \times 10^{-4} \\
\varepsilon_{1.1} &= \dfrac{3!}{5!} h^4M=2.8125\times 10^{-5} \\
\varepsilon_{1.2} &= \dfrac{4}{5!} h^4M=1.875 \times 10^{-5}
\end{align}
$$
